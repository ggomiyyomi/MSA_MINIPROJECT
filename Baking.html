<!DOCTYPE html>
<html lang="ko" data-bs-theme="light">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>í¬ì •'s ì·¨ë¯¸ í˜ì´ì§€</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f3c9f0ec8669c2333a8b6964f82e24ae&libraries=services"></script>
    <style>
        .hero {
            min-height: 40vh;
            display: grid;
            place-items: center;
            background: url("/images/ì£¼ë°©.png") center/cover no-repeat;
            position: relative;
            color: #fff;
        }

        .hero::after {
            content: "";
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, .4);
        }

        .hero .inner {
            position: relative;
            z-index: 1;
        }

        .avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid #fff;
        }

        .gallery-img {
            aspect-ratio: 4/3;
            object-fit: cover;
        }

        .fixed-back {
            position: fixed;
            left: 16px;
            bottom: 16px;
            z-index: 1030;
        }

        .bg-body-secondary {
            background-color: #a58864 !important;
            color: #fdf8f4;
        }

        .text-brown {
            color: #a58864;
        }

        .cafe-section {
            background: #fdf8f4;
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
        }

        .cafe-tags .badge {
            background: #a58864;
            color: #fff;
            font-size: .85rem;
            padding: .5em .9em;
        }

        .cafe-photo img {
            border-radius: 12px;
            transition: transform .3s ease;
            width: 100%;
            height: auto;
            max-height: 400px;
            object-fit: cover;
            border-radius: 12px;
        }

        .cafe-photo img:hover {
            transform: scale(1.05);
        }

        .cafe-review {
            font-size: 1rem;
            font-style: italic;
            color: #5a4636;
            background: #fdf1e6;
            padding: 1rem;
            border-radius: 12px;
        }

        .btn-brown {
            background: #a58864;
            color: #fff;
        }

        .btn-brown:hover {
            background: #8a6f4e;
            color: #fff;
        }

        .delete-icon {
            font-size: 1.2rem;
            transition: transform .2s ease, color .2s ease;
        }

        .delete-icon:hover {
            transform: scale(1.2) rotate(-10deg);
            color: #ff6b6b;
        }

        .cafe-form-card {
            border: 1px solid #fffdf9;
            border-radius: 16px;
            padding: 2rem;
            transition: transform .2s, box-shadow .2s;
        }

        .cafe-form-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 18px rgba(0, 0, 0, 0.08);
        }

        .form-custom {
            border-radius: 10px;
            border: 1px solid #e0c9a6;
            transition: border .2s, box-shadow .2s;
        }

        .form-custom:focus {
            border-color: #a58864;
            box-shadow: 0 0 0 .2rem rgba(165, 136, 100, .25);
        }

        .result-item {
            cursor: pointer;
        }

        .result-item:hover {
            background: #fff7ec;
        }

        .cafe-section .fa-location-dot {
            color: #a58864;
        }


        #searchResults {
            padding-right: 12px;
            border: none;
        }

        #searchResults .list-group-item {
            border: none !important;
            padding: 10px 8px;
        }

        #searchResults .list-group-item:hover {
            background: #e2caac;
        }



        #searchResults::-webkit-scrollbar {
            width: 8px;
        }

        #searchResults::-webkit-scrollbar-track {
            background: none;
            border-radius: 10px;
        }

        #searchResults::-webkit-scrollbar-thumb {
            background: #a58864;
            border-radius: 10px;
        }

        #modalImage {
        max-height: 90vh;
        object-fit: contain;
        }
    </style>
</head>

<body>
    <!-- Nav -->
    <nav class="navbar navbar-expand-lg bg-body-tertiary sticky-top shadow-sm">
        <div class="container">
            <a class="navbar-brand fw-bold" href="#top">My Memory</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div id="nav" class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="#about">Guestbook</a></li>
                    <li class="nav-item"><a class="nav-link" href="#hobbies">Video</a></li>
                    <li class="nav-item"><a class="nav-link" href="#memories">Music</a></li>
                    <li class="nav-item"><a class="nav-link" href="#media">Drawing</a></li>
                    <li class="nav-item"><a class="nav-link" href="#guestbook">CAFE Map</a></li>
                </ul>
                <div class="d-flex gap-2 align-items-center">
                    <button id="themeToggle" class="btn btn-outline-secondary btn-sm" type="button"
                        title="ë¼ì´íŠ¸/ë‹¤í¬ ì „í™˜">ğŸŒ“</button>
                </div>
            </div>
        </div>
    </nav>

    <a href="index.html" class="btn btn-outline-secondary fixed-back">â† ë©”ì¸</a>

    <header class="hero">
        <div class="inner text-center">
            <img src="/images/í”„ë¡œí•„.png" alt="í”„ë¡œí•„" class="avatar mb-3">
            <h1 class="fw-bold">í¬ì •'s BAKING</h1>
            <p class="lead mb-0">í•  ì¤„ ì•„ëŠ” ê±´ ìš°ì„  ì¿ í‚¤</p>
        </div>
    </header>

    <!-- ì†Œê°œ -->
    <section class="py-5">
        <div class="container">
            <h2 class="h4 fw-bold mb-3 text-brown">ì†Œê°œ</h2>
            <p>
                ë¹µê³¼ ì¿ í‚¤, ì´ˆì½œë¦¿ ì—†ìœ¼ë©´ ëª»ì‚´ì•„ì„œ ì§ì ‘ ë§Œë“¤ê³ ì‹¶ì€ ë¹µìˆœğŸì…ë‹ˆë‹¤.<br>
                ê°€ë”ì”© ì‹¬ì‹¬í•˜ê±°ë‚˜ ë§Œë“¤ê³ ì‹¶ì„ë•Œ ëŒ€ëŸ‰ìœ¼ë¡œ ë§Œë“¤ì–´ë²„ë ¤ì„œ ë‚˜ëˆ ì£¼ëŠ”ê±¸ ì¢‹ì•„í•´ìš”.<br>
                ì§€ê¸ˆì€ ì¿ í‚¤ë§Œ ë§Œë“¤ì¤„ ì•Œì§€ë§Œ... ë‚˜ì¤‘ì—” ë¹µë„ ë§Œë“¤ìˆ˜ ìˆëŠ” ì‚¬ëŒì´ ë˜ê¸¸ ğŸ™ğŸ»
            </p>
        </div>
    </section>

    <!-- ì¿ í‚¤ ê°¤ëŸ¬ë¦¬ -->
    <section class="py-5 bg-body-secondary">
        <div class="container">
            <h2 class="h4 fw-bold mb-3">Cookieë“¤</h2>
            <div class="row g-4">
                <div class="col-12 col-sm-6 col-lg-3"><img src="/images/ê±°ë¶ì´ì¿ í‚¤.png"
                        class="w-100 rounded-3 shadow-sm gallery-img"></div>
                <div class="col-12 col-sm-6 col-lg-3"><img src="/images/ì¿ í‚¤ê³µì¥.png"
                        class="w-100 rounded-3 shadow-sm gallery-img"></div>
                <div class="col-12 col-sm-6 col-lg-3"><img src="/images/ë§ˆë£¨ì¿ í‚¤.png"
                        class="w-100 rounded-3 shadow-sm gallery-img"></div>
                <div class="col-12 col-sm-6 col-lg-3"><img src="/images/ì •ì²´ëª¨ë¥¼ê³°ëŒì´ì¿ í‚¤.png"
                        class="w-100 rounded-3 shadow-sm gallery-img"></div>
            </div>
        </div>
    </section>

    <!-- Recommend CAFE  -->
    <section class="py-5">
        <h1 class="h4 fw-bold mb-4 text-center">â˜•ï¸ Recommend CAFE</h1>

        <div id="cafe-list">
            <!-- ì˜ˆì‹œ -->
            <div class="container cafe-section mb-4">
                <h2 class="h5 fw-bold mb-3">ë¡œìŠ¤íŠ¸ì•¤ë² ì´í¬ ê°€ë½ì </h2>
                <div class="d-flex flex-wrap gap-2 cafe-tags mb-4">
                    <span class="badge rounded-pill">#ì„œìš¸ì†¡íŒŒ</span>
                    <span class="badge rounded-pill">#ì–‘ì‹</span>
                    <span class="badge rounded-pill">#íƒ€ë¥´íŠ¸</span>
                    <span class="badge rounded-pill">#ë¹µ</span>
                </div>
                <div class="row g-3">
                    <div class="col-md-6 cafe-photo">
                        <h6 class="fw-semibold mb-2 text-brown">PHOTO</h6>
                        <div class="row g-3">
                            <div class="col-6"><img src="/images/íƒ€ë¥´íŠ¸1.png" class="w-100 shadow-sm" alt="íƒ€ë¥´íŠ¸1"></div>
                            <div class="col-6"><img src="/images/íƒ€ë¥´íŠ¸2.png" class="w-100 shadow-sm" alt="íƒ€ë¥´íŠ¸2"></div>
                        </div>
                    </div>
                    <div class="col-md-6 d-flex flex-column justify-content-between">
                        <div>
                            <h6 class="fw-semibold mb-2 text-brown">í•œì¤„í›„ê¸°</h6>
                            <div class="cafe-review">ê²‰ë°”ì†ì´‰ ê·¸.ì.ì²´ ğŸ“â¤ï¸</div>
                        </div>

                        <div>
                            <h6 class="fw-semibold mt-3 mb-2 text-brown">ì¹´í˜ ìœ„ì¹˜ ë³´ê¸°</h6>
                            <div id="map-fixed-addr" class="small text-muted mb-2">
                                <i class="fa-solid fa-location-dot text-brown me-1"></i><span></span>
                            </div>
                            <div id="map-fixed" style="width:100%;height:220px;border-radius:10px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ìƒˆ ì¹´í˜ ë“±ë¡ í¼ -->
        <div class="container mt-5">
            <div class="card cafe-form-card shadow-sm border-0">
                <div class="card-body">
                    <h2 class="h5 fw-bold mb-4 text-center text-brown">ì¹´í˜ ì¶”ì²œí•˜ê¸°</h2>
                    <form id="cafeForm">
                        <div class="mb-3">
                            <label class="form-label fw-semibold"><i class="fa-solid fa-store me-2 text-brown"></i>ì¹´í˜
                                ì´ë¦„</label>
                            <input type="text" class="form-control form-custom" id="cafeName" required>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold"><i class="fa-solid fa-tags me-2 text-brown"></i>íƒœê·¸
                                (ì‰¼í‘œë¡œ êµ¬ë¶„)</label>
                            <input type="text" class="form-control form-custom" id="cafeTags" placeholder="#ì†¡íŒŒ, #íƒ€ë¥´íŠ¸">
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold"><i class="fa-solid fa-image me-2 text-brown"></i>ì‚¬ì§„
                                ì—…ë¡œë“œ (ìµœëŒ€ 2ì¥)</label>
                            <input type="file" class="form-control form-custom" id="cafePhotos" accept="image/*"
                                multiple>
                        </div>

                        <!-- ìœ„ì¹˜ ê²€ìƒ‰/ì„ íƒ -->
                        <div class="mb-3">
                            <label class="form-label fw-semibold"><i
                                    class="fa-solid fa-map-location-dot me-2 text-brown"></i>ìœ„ì¹˜ ì„ íƒ</label>
                            <div class="input-group mb-2">
                                <input type="text" id="placeKeyword" class="form-control form-custom"
                                    placeholder="ì˜ˆ: ë¡œìŠ¤íŠ¸ì•¤ë² ì´í¬ ê°€ë½ì ">
                                <button type="button" id="btnSearch" class="btn btn-brown">ê²€ìƒ‰</button>
                            </div>
                            <div class="row g-3 mt-2">
                                <div class="col-md-7">
                                    <div id="selectMap" style="width:100%;height:260px;border-radius:10px;"></div>
                                </div>
                                <div class="col-md-5">
                                    <ul id="searchResults" class="list-group small"
                                        style="max-height:260px;overflow:auto;"></ul>
                                </div>
                            </div>
                            <div id="chosenAddress" class="small text-muted mt-2"></div>
                        </div>

                        <div class="mb-3">
                            <label class="form-label fw-semibold"><i class="fa-solid fa-pen-nib me-2 text-brown"></i>í•œì¤„
                                í›„ê¸°</label>
                            <input type="text" class="form-control form-custom" id="cafeReview" required>
                        </div>

                        <!-- ìˆ¨ê¹€ ì£¼ì†Œ -->
                        <input type="hidden" id="cafeLat">
                        <input type="hidden" id="cafeLng">
                        <input type="hidden" id="cafeAddress">

                        <div class="text-center">
                            <button type="submit" class="btn btn-brown px-4 py-2 rounded-pill shadow-sm">
                                <i class="fa-solid fa-plus me-1"></i> ë“±ë¡
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </section>

    <!-- ì´ë¯¸ì§€ ëª¨ë‹¬ -->
<div class="modal fade" id="imageModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content bg-transparent border-0 shadow-none">
      <div class="modal-body text-center p-0">
        <img id="modalImage" src="" class="img-fluid rounded shadow-lg" alt="ì›ë³¸ ì´ë¯¸ì§€">
      </div>
    </div>
  </div>
</div>


    <footer class="py-4 bg-body-tertiary text-center small text-body-secondary">
        Â© <span id="year"></span> ë‚˜ì˜ ì¶”ì–µ í˜ì´ì§€
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.getElementById('year').textContent = new Date().getFullYear();


        const themeToggle = document.getElementById('themeToggle');
        const docEl = document.documentElement;
        const THEME_KEY = 'onepage-theme';
        const savedTheme = localStorage.getItem(THEME_KEY);
        if (savedTheme) docEl.setAttribute('data-bs-theme', savedTheme);
        themeToggle.addEventListener('click', () => {
            const cur = docEl.getAttribute('data-bs-theme') || 'light';
            const next = cur === 'light' ? 'dark' : 'light';
            docEl.setAttribute('data-bs-theme', next);
            localStorage.setItem(THEME_KEY, next);
        });


        function getCafes() { return JSON.parse(localStorage.getItem('cafes')) || []; }
        function saveCafes(cafes) { localStorage.setItem('cafes', JSON.stringify(cafes)); }
        function addCafe(cafe) { const cs = getCafes(); cs.push(cafe); saveCafes(cs); }
        function removeCafe(index) { const cs = getCafes(); cs.splice(index, 1); saveCafes(cs); }


        function appendCafe(cafe, photos = [], index) {
            const wrap = document.createElement('div');
            wrap.className = 'container cafe-section mb-4';
            const mapId = `map-${index}-${Date.now()}`;
            wrap.innerHTML = `
                <div class="d-flex justify-content-between align-items-start">
                <h2 class="h5 fw-bold mb-3">${cafe.name}</h2>
                <i class="fa-solid fa-trash-can text-danger delete-icon" style="cursor:pointer;"></i>
                </div>
                <div class="d-flex flex-wrap gap-2 cafe-tags mb-4">
                ${(cafe.tags || []).map(t => `<span class="badge rounded-pill">${t}</span>`).join('')}
                </div>
                <div class="row g-4">
                <div class="col-md-6 cafe-photo">
                    <h6 class="fw-semibold mb-2 text-brown">PHOTO</h6>
                    <div class="row g-3">
            ${photos.map((p, i) => {
                            let colClass = 'col-6'; // ê¸°ë³¸ 2ì¥ì´ë©´ ë°˜ë°˜
                            if (photos.length === 1) colClass = 'col-12'; // ì‚¬ì§„ 1ì¥ì´ë©´ ì „ì²´ í­
                            else if (photos.length === 3) colClass = 'col-4'; // ì‚¬ì§„ 3ì¥ì´ë©´ 3ë“±ë¶„
                            return `<div class="${colClass}"><img src="${p}" class="w-100 shadow-sm rounded-3" alt="cafe photo"></div>`;
                        }).join('')}
            </div>

                </div>
                <div class="col-md-6 d-flex flex-column justify-content-between">
                    <div>
                    <h6 class="fw-semibold mb-2 text-brown">í•œì¤„í›„ê¸°</h6>
                    <div class="cafe-review">${cafe.review || ''}</div>
                    </div>
                    <div>
                    <h6 class="fw-semibold mt-3 mb-2 text-brown">ì¹´í˜ ìœ„ì¹˜ ë³´ê¸°</h6>
                    ${cafe.address ? `<div class="small text-muted mb-2">
                        <i class="fa-solid fa-location-dot me-1"></i>${cafe.address}
                    </div>` : ''}
                    <div id="${mapId}" style="width:100%;height:220px;border-radius:10px;"></div>
                    </div>
                </div>
                </div>
            `;
            // ì‚­ì œ
            wrap.querySelector('.delete-icon').addEventListener('click', () => {
                if (confirm('ì´ ì¹´í˜ë¥¼ ì‚­ì œí• ê¹Œìš”?')) { removeCafe(index); wrap.remove(); }
            });
            document.getElementById('cafe-list').appendChild(wrap);

            // ì§€ë„
            if (cafe.lat && cafe.lng) {
                const map = new kakao.maps.Map(document.getElementById(mapId), {
                    center: new kakao.maps.LatLng(cafe.lat, cafe.lng), level: 3
                });
                new kakao.maps.Marker({ position: new kakao.maps.LatLng(cafe.lat, cafe.lng), map });
            }

        }

        /* ====== ì´ˆê¸° ë¡œë“œ: ì €ì¥ëœ ì¹´í˜ ====== */
        function loadCafes() {
            const cafes = getCafes();
            cafes.forEach((c, i) => appendCafe(c, [], i));
        }

        /* ====== ì˜ˆì‹œ ì§€ë„ ====== */
        function initFixedExample() {
            const el = document.getElementById('map-fixed');
            if (!el) return;
            const map = new kakao.maps.Map(el, { center: new kakao.maps.LatLng(37.5665, 126.9780), level: 7 });
            const places = new kakao.maps.services.Places();

            // í‚¤ì›Œë“œ ê²€ìƒ‰
            places.keywordSearch('ë¡œìŠ¤íŠ¸ì•¤ë² ì´í¬ ê°€ë½ì ', (data, status) => {
                if (status !== kakao.maps.services.Status.OK || !data.length) return;
                const p = data[0]; // ê°€ì¥ ê´€ë ¨ ë†’ì€ ê²°ê³¼
                const latlng = new kakao.maps.LatLng(p.y, p.x);
                map.setLevel(3); map.setCenter(latlng);
                new kakao.maps.Marker({ position: latlng, map });

                // âœ… span ì•ˆì— ì£¼ì†Œ ë„£ê¸°
                const addrBox = document.querySelector('#map-fixed-addr span');
                if (addrBox) addrBox.textContent = p.road_address_name || p.address_name || '';
            });
        }

        /* ====== í¼: ì§€ë„/ê²€ìƒ‰/ì„ íƒ ====== */
        function initForm() {
            const selectMapEl = document.getElementById('selectMap');
            const selectMap = new kakao.maps.Map(selectMapEl, {
                center: new kakao.maps.LatLng(37.5665, 126.9780), level: 7
            });
            const places = new kakao.maps.services.Places();
            const geocoder = new kakao.maps.services.Geocoder();
            const resultsEl = document.getElementById('searchResults');
            const keywordEl = document.getElementById('placeKeyword');
            const chosenAddrEl = document.getElementById('chosenAddress');
            let selMarker;

            function setSelected(latlng) {
                document.getElementById('cafeLat').value = latlng.getLat();
                document.getElementById('cafeLng').value = latlng.getLng();
                if (selMarker) selMarker.setMap(null);
                selMarker = new kakao.maps.Marker({ position: latlng, map: selectMap });
            }

            // ì§€ë„ í´ë¦­ìœ¼ë¡œ ì„ íƒ
            kakao.maps.event.addListener(selectMap, 'click', (e) => {
                setSelected(e.latLng);
            });

            // ê²€ìƒ‰ ì‹¤í–‰
            function doSearch() {
                const q = (keywordEl.value || '').trim();
                resultsEl.innerHTML = '';
                if (!q) return;
                places.keywordSearch(q, (data, status) => {
                    if (status !== kakao.maps.services.Status.OK || !data.length) {
                        resultsEl.innerHTML = '<li class="list-group-item">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”.</li>'; return;
                    }
                    const bounds = new kakao.maps.LatLngBounds();
                    data.forEach(item => {
                        const li = document.createElement('li');
                        li.className = 'list-group-item result-item';
                        li.innerHTML = `<strong>${item.place_name}</strong><br><small class="text-muted">${item.road_address_name || item.address_name || ''}</small>`;
                        li.addEventListener('click', () => {
                            const latlng = new kakao.maps.LatLng(item.y, item.x);
                            selectMap.setLevel(3); selectMap.panTo(latlng);
                            setSelected(latlng, item.road_address_name || item.address_name || '');
                        });
                        resultsEl.appendChild(li);
                        bounds.extend(new kakao.maps.LatLng(item.y, item.x));
                    });
                    selectMap.setBounds(bounds);
                });
            }
            document.getElementById('btnSearch').addEventListener('click', doSearch);
            keywordEl.addEventListener('keydown', e => { if (e.key === 'Enter') { e.preventDefault(); doSearch(); } });

            // í¼ ì œì¶œ
            document.getElementById('cafeForm').addEventListener('submit', (e) => {
                e.preventDefault();
                const name = document.getElementById('cafeName').value.trim();
                const tags = document.getElementById('cafeTags').value.split(',').map(t => t.trim()).filter(Boolean);
                const review = document.getElementById('cafeReview').value.trim();
                const lat = parseFloat(document.getElementById('cafeLat').value);
                const lng = parseFloat(document.getElementById('cafeLng').value);
                const address = document.getElementById('cafeAddress').value;

                // ì‚¬ì§„ì€ ì¦‰ì‹œ ë¯¸ë¦¬ë³´ê¸°ë§Œ (ì €ì¥ X)
                const files = document.getElementById('cafePhotos').files;
                const photos = [];
                for (let file of files) { photos.push(URL.createObjectURL(file)); }

                const newCafe = { name, tags, review, lat, lng, address };
                addCafe(newCafe);
                appendCafe(newCafe, photos, getCafes().length - 1);
                e.target.reset();
                resultsEl.innerHTML = '';
                chosenAddrEl.textContent = '';
                if (selMarker) { selMarker.setMap(null); selMarker = null; }
            });
        }

        // ëª¨ë‹¬ ì°¸ì¡°
        const imageModal = new bootstrap.Modal(document.getElementById('imageModal'));
        const modalImage = document.getElementById('modalImage');

        document.addEventListener('click', function(e) {
            if (e.target.tagName === 'IMG' && e.target.closest('.cafe-photo')) {
                modalImage.src = e.target.src; 
                imageModal.show();
            }
        });


        /* ====== ì‹¤í–‰ ìˆœì„œ ====== */
        document.addEventListener('DOMContentLoaded', () => {
            loadCafes();
            initFixedExample();
            initForm();
        });
    </script>

    
</body>

</html>