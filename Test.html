<!--BOOK-->

<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Book with Thin Tabs & Covers</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0}
  :root {
    --page-count: 20;
    --page-scroll: 25;
    --underline: hsla(0,0%,25%,0.4);
    --spine: hsl(0,0%,0%);
    --cover: hsl(0,0%,10%);
    --bg: hsl(0,0%,30%);
    --insert: hsl(0,0%,85%);
    --page: hsl(0,0%,90%);
  }
  body {
    width:100vw;
    height:calc(((var(--page-count) + 2) * var(--page-scroll)) * 1vh);
    background:var(--bg);
    overflow-x:hidden;
  }
  .book {
    height:40vmin; width:30vmin; min-width:150px; min-height:200px;
    position:fixed; top:50%; left:50%;
    transform:translate(-50%,-50%) scale(.5);
    transform-style:preserve-3d; perspective:1200px;
  }
  .book__page {
    position:absolute; left:2%; top:50%;
    border-radius:0 5% 5% 0;
    transform:translate(0,-50%);
    height:94%; width:94%;
    z-index:calc(((var(--page-count)+2)-var(--page-index))*2);
    transform-origin:0% 50%;
  }
  .page__half {
    display:flex; align-items:center; justify-content:center;
    height:100%; position:absolute; top:0; left:0; width:100%;
    transform:rotateY(calc(var(--rotation)*1deg)) translate3d(0,0,calc((0.5*var(--coefficient))*1px));
    -webkit-clip-path:inset(0 0.5% 0 0.5%);
    clip-path:inset(0 0.5% 0 0.5%);
  }
  .page__half--front { --rotation:0; --coefficient:0; backface-visibility:hidden; border-radius:0 5% 5% 0; }
  .page__half--back { --rotation:180; --coefficient:2; border-radius:5% 0 0 5%; }

  /* ì¢…ì´ í˜ì´ì§€ */
  .book__page:not(.book__cover) .page__half {
    background:repeating-linear-gradient(0deg,transparent 0 1rem,var(--underline) 1rem calc(1rem + 1px),transparent calc(1rem + 1px)) 0 1rem/100% 100% no-repeat,var(--page);
  }

  /* í‘œì§€ ìŠ¤íƒ€ì¼ */
  .book__cover {
    border-radius:0 5% 5% 0;
    height:100%; width:100%;
    position:absolute; top:50%; left:0;
    background:var(--cover);
  }
  .book__cover--front .page__half--back { border-right:1rem solid var(--spine) }
  .book__cover--back .page__half--front { border-left:1rem solid var(--spine) }

  img { width:90%; height:90%; object-fit:contain; z-index:2 }

  /* ì–‡ì€ ì±…ê°ˆí”¼ */
  .bookmark-tab {
    position:absolute;
    top:-10px;
    width:15px; height:30px;
    border-radius:2px 2px 0 0;
    cursor:pointer;
    box-shadow:0 1px 2px rgba(0,0,0,0.3);
    opacity:0.8;
    transition:transform .2s, opacity .2s;
    transform: translateX(10px);
  }
  .bookmark-tab:hover {
    transform:translateY(-1px) scale(1.1);
    opacity:1;
  }
</style>
</head>
<body>

<div class="book"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>
<script>
const colors = ['crimson','orange','gold','limegreen','deepskyblue','dodgerblue','blueviolet','hotpink','mediumslateblue','tomato'];
const SRC = ['Book','Cubes','Elon','Gun','Kitkat','Launch','Pino','Pokedex','Record','Tcannon'];
const totalPages = 10;

const book = document.querySelector('.book');

// ğŸ“˜ ì•í‘œì§€
const front = document.createElement('div');
front.className = 'page book__page book__cover book__cover--front';
front.style.setProperty('--page-index',1);
front.innerHTML = `
  <div class="page__half page__half--front"></div>
  <div class="page__half page__half--back"></div>
`;
book.appendChild(front);

// ğŸ“‘ ë‚´ë¶€ í˜ì´ì§€ (ì±…ê°ˆí”¼ ìë™ ê· ë“±)
for(let i=0;i<totalPages;i++){
  const p=document.createElement('div');
  p.className='page book__page';
  p.style.setProperty('--page-index',i+2);

  // ìœ„ì¹˜ë¥¼ px ëŒ€ì‹  % ë¹„ìœ¨ë¡œ
  const leftPercent = (i/(totalPages-1))*80; // ì±… í­(ì•½ 80%) ê¸°ì¤€ ê· ë“±

  p.innerHTML=`
    <div class="bookmark-tab" style="background:${colors[i]}; left:${leftPercent}%;" title="${i+1}í˜ì´ì§€"></div>
    <div class="page__half page__half--front">
      <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/${SRC[Math.floor(Math.random()*SRC.length)]}-sketch.svg">
    </div>
    <div class="page__half page__half--back">
      <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/605876/${SRC[Math.floor(Math.random()*SRC.length)]}-sketch.svg">
    </div>
  `;
  book.appendChild(p);

  p.querySelector('.bookmark-tab').addEventListener('click',()=>{
    window.scrollTo({ top: (i+1)*(window.innerHeight*0.25), behavior:'smooth' });
  });
}

// ğŸ“˜ ë’¤í‘œì§€
const back = document.createElement('div');
back.className = 'page book__page book__cover book__cover--back';
back.style.setProperty('--page-index',totalPages+2);
back.innerHTML = `
  <div class="page__half page__half--front"></div>
  <div class="page__half page__half--back"></div>
`;
book.appendChild(back);

// ğŸ“– GSAP ë„˜ê¹€ ì• ë‹ˆë©”ì´ì…˜
gsap.registerPlugin(ScrollTrigger);
const pages = [...document.querySelectorAll('.book__page')];
pages.forEach((page,index)=>{
  gsap.set(page,{z:index===0?13:-index*1});
  gsap.to(page,{
    rotateY:`-=${180 - index/2}`,
    scrollTrigger:{
      scrub:1,
      start:()=> (index+1)*(window.innerHeight*0.25),
      end:()=> (index+2)*(window.innerHeight*0.25)
    }
  });
  gsap.to(page,{
    z:index===0?-13:index,
    scrollTrigger:{
      scrub:1,
      start:()=> (index+1)*(window.innerHeight*0.25),
      end:()=> (index+1.5)*(window.innerHeight*0.25)
    }
  });
});
</script>

</body>
</html>
